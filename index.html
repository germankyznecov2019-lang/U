<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>shivrowka</title>

<style>
:root{
    --bg:#f5f7fb;
    --card:#ffffff;
    --text:#111;
    --accent:linear-gradient(135deg,#667eea,#764ba2);
}

body.dark{
    --bg:#0f172a;
    --card:#1e293b;
    --text:#ffffff;
    --accent:linear-gradient(135deg,#06b6d4,#3b82f6);
}

body{
    margin:0;
    padding:20px;
    background:var(--bg);
    color:var(--text);
    font-family:Inter, Helvetica, Arial, sans-serif;
    transition:0.3s;
}

.logo{
    text-align:center;
    font-size:26px;
    letter-spacing:6px;
    font-weight:500;
    margin-bottom:30px;
}

.card{
    background:var(--card);
    padding:20px;
    border-radius:20px;
    box-shadow:0 10px 30px rgba(0,0,0,0.1);
    margin-bottom:20px;
}

textarea,input{
    width:100%;
    border:none;
    border-radius:14px;
    padding:14px;
    font-size:16px;
    margin-bottom:15px;
    background:rgba(0,0,0,0.05);
    color:var(--text);
}

body.dark textarea,
body.dark input{
    background:rgba(255,255,255,0.08);
}

.button{
    width:100%;
    padding:14px;
    border:none;
    border-radius:14px;
    font-size:16px;
    font-weight:600;
    color:white;
    cursor:pointer;
    background:var(--accent);
    transition:0.2s;
}

.button:hover{
    transform:translateY(-2px);
    box-shadow:0 6px 20px rgba(0,0,0,0.2);
}

.settings{
    text-align:right;
    margin-bottom:15px;
    font-size:14px;
}
</style>
</head>
<body>

<div class="logo">shivrowka</div>

<div class="settings">
    <label>
        <input type="checkbox" id="themeToggle"> Тёмная тема
    </label>
</div>

<div class="card">
    <textarea id="text" placeholder="Введите текст..."></textarea>
    <input id="numberKey" placeholder="Введите номер (только цифры)" inputmode="numeric">
    <button class="button" onclick="encrypt()">Русский → ShiVrowKa</button>
    <button class="button" onclick="decrypt()">ShiVrowKa → Русский</button>
</div>

<script>

// ===== ТЕМА =====
const toggle = document.getElementById("themeToggle");

if(localStorage.getItem("theme")==="dark"){
    document.body.classList.add("dark");
    toggle.checked=true;
}

toggle.addEventListener("change",()=>{
    if(toggle.checked){
        document.body.classList.add("dark");
        localStorage.setItem("theme","dark");
    }else{
        document.body.classList.remove("dark");
        localStorage.setItem("theme","light");
    }
});

// ===== ШИФР =====
function getShift(number){
    let sum=0;
    for(let i=0;i<number.length;i++){
        sum+=parseInt(number[i]);
    }
    return sum;
}

function encrypt(){
    const text=document.getElementById("text").value;
    const number=document.getElementById("numberKey").value;

    if(!text || !number.match(/^[0-9]+$/)){
        alert("Введите текст и номер");
        return;
    }

    const shift=getShift(number);
    let result="";

    for(let i=0;i<text.length;i++){
        result+=String.fromCharCode(text.charCodeAt(i)+shift);
    }

    document.getElementById("text").value=
        btoa(unescape(encodeURIComponent(result)));
}

function decrypt(){
    const cipher=document.getElementById("text").value;
    const number=document.getElementById("numberKey").value;

    if(!cipher || !number.match(/^[0-9]+$/)){
        alert("Введите текст и номер");
        return;
    }

    try{
        const shift=getShift(number);
        const decoded=decodeURIComponent(escape(atob(cipher)));
        let result="";

        for(let i=0;i<decoded.length;i++){
            result+=String.fromCharCode(decoded.charCodeAt(i)-shift);
        }

        document.getElementById("text").value=result;

    }catch{
        document.getElementById("text").value=
        "ЛвщжылчдаодашезЗяхдкзужвьслсщж";
    }
}

</script>

</body>
</html>
